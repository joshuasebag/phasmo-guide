
<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Journal minimal – Phasmophobia</title>
  <style>
    body{margin:0; font-family:system-ui,Segoe UI,Roboto,Arial; background:#0e1016; color:#e6e9ef}
    header{position:sticky; top:0; background:#121420; padding:12px 14px; border-bottom:1px solid #20283a}
    .wrap{max-width:1000px; margin:0 auto; padding:0 14px}
    .tabs{display:flex; gap:8px}
    .tab{padding:8px 12px; border:1px solid #20283a; border-bottom:none; border-radius:10px 10px 0 0; background:#0d1120; color:#cfd6e6; text-decoration:none}
    .tab[data-active="true"]{background:#151a2a; color:#fff}
    main{padding:14px}
    .book{display:grid; grid-template-columns:1fr; gap:18px; background:#121420; border:1px solid #20283a; border-radius:14px; padding:18px}
    .chips{display:flex; flex-wrap:wrap; gap:8px}
    .chip{display:flex; align-items:center; gap:8px; padding:8px 10px; background:#1b2131; border:1px solid #20283a; border-radius:999px}
    .chip .name{font-weight:600}
    .chip button{appearance:none; border:1px solid #20283a; background:#0e1322; color:#cfd6e6; padding:3px 7px; border-radius:7px; cursor:pointer; font-size:12px}
    .chip button[data-state="include"]{border-color:#1e3a2f; background:#0c1713; color:#a7f3d0}
    .chip button[data-state="exclude"]{border-color:#3a1e1e; background:#170c0c; color:#fecaca}
    section[hidden]{display:none !important}
    .count{color:#9aa3b2}
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <nav class="tabs" role="tablist" aria-label="Sections du journal">
        <a class="tab" href="#journal" id="tab-journal">Journal</a>
        <a class="tab" href="#fantomes" id="tab-fantomes">Fantômes</a>
        <a class="tab" href="#options" id="tab-options">Options</a>
      </nav>
    </div>
  </header>

  <main class="wrap">
    <div class="book">
      <section id="journal">
        <h2>Preuves</h2>
        <p class="count" id="state-summary" aria-live="polite"></p>
        <div class="chips" id="proof-chips"></div>
      </section>
      <section id="fantomes" hidden>
        <p>Section Fantômes (placeholder)</p>
      </section>
      <section id="options" hidden>
        <button id="reset-all">Réinitialiser</button>
      </section>
    </div>
  </main>

  <script>
    // --- Données
    const PROOFS = [
      { id:'emf', label:'EMF Niveau 5' },
      { id:'orbe', label:'Orbe' },
      { id:'spirit', label:'Spirit Box' },
      { id:'freezing', label:'Températures glaciales' },
      { id:'uv', label:'Traces UV' },
      { id:'dots', label:'D.O.T.S' },
      { id:'writing', label:'Écriture fantomatique' },
    ];

    // --- État persistant
    const STORAGE_KEY = 'phasmo_journal_min_v1';
    function loadState(){
      try { return JSON.parse(localStorage.getItem(STORAGE_KEY)) ?? { include:[], exclude:[], tab:'#journal' }; }
      catch { return { include:[], exclude:[], tab:'#journal' }; }
    }
    function saveState(s){ localStorage.setItem(STORAGE_KEY, JSON.stringify(s)); }
    let state = loadState();

    // --- Onglets
    const tabs = Array.from(document.querySelectorAll('.tab'));
    const sections = {
      '#journal': document.getElementById('journal'),
      '#fantomes': document.getElementById('fantomes'),
      '#options': document.getElementById('options'),
    };
    function setActiveTab(hash){
      const h = sections[hash] ? hash : '#journal';
      Object.entries(sections).forEach(([k,el]) => el.hidden = (k !== h));
      tabs.forEach(a => a.dataset.active = (a.getAttribute('href') === h));
      state.tab = h; saveState(state);
      if (location.hash !== h) history.replaceState(null,'',h);
    }
    window.addEventListener('hashchange', () => setActiveTab(location.hash));
    setActiveTab(state.tab || location.hash || '#journal');

    // --- Preuves
    const chipsRoot = document.getElementById('proof-chips');
    const summaryEl = document.getElementById('state-summary');

    function renderChips(){
      chipsRoot.innerHTML = '';
      PROOFS.forEach(p => {
        const wrap = document.createElement('div');
        wrap.className = 'chip';
        wrap.innerHTML = `
          <span class="name">${p.label}</span>
          <span class="actions">
            <button type="button" class="btn" data-action="include" data-proof="${p.id}">Inclure</button>
            <button type="button" class="btn" data-action="exclude" data-proof="${p.id}">Exclure</button>
            <button type="button" class="btn" data-action="clear"   data-proof="${p.id}">Effacer</button>
          </span>
        `;
        const [bInc, bExc] = wrap.querySelectorAll('button');
        if (state.include.includes(p.id)) bInc.setAttribute('data-state','include');
        if (state.exclude.includes(p.id)) bExc.setAttribute('data-state','exclude');
        chipsRoot.appendChild(wrap);
      });
      updateSummary();
    }

    function updateSummary(){
      const inc = state.include.map(id => PROOFS.find(p=>p.id===id)?.label).filter(Boolean);
      const exc = state.exclude.map(id => PROOFS.find(p=>p.id===id)?.label).filter(Boolean);
      summaryEl.textContent = `Inclus: ${inc.length?inc.join(', '):'—'} | Exclus: ${exc.length?exc.join(', '):'—'}`;
    }

    chipsRoot.addEventListener('click', (e) => {
      const btn = e.target.closest('button'); if(!btn) return;
      const id = btn.dataset.proof, action = btn.dataset.action;
      // Nettoyer des deux listes d’abord
      state.include = state.include.filter(x => x !== id);
      state.exclude = state.exclude.filter(x => x !== id);
      if (action === 'include') state.include.push(id);
      if (action === 'exclude') state.exclude.push(id);
      saveState(state);
      renderChips();
    });

    document.getElementById('reset-all').addEventListener('click', () => {
      state.include = []; state.exclude = []; saveState(state); renderChips();
    });

    // Render initial
    renderChips();
  </script>
</body>
</html>
